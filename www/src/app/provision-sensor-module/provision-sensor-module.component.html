<!--
- Validation
- Actually add to DB
- Populate Room/Location from DB
- List of existing data in grid
-->

<h2>Provision Sensor Module</h2>

<p>Add the details of a new sensor module to provision below, then hit the Go button.</p>

<mat-grid-list cols="4" rowHeight="70px">
  <mat-grid-tile colspan="4">
    <h3>Core Information</h3>
  </mat-grid-tile>
  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Serial Number</mat-label>
      <input matInput type="text" [formControl]="serialNumber" [errorStateMatcher]="matcher" required />
      <button mat-button *ngIf="serialNumber.value" matSuffix mat-icon-button aria-label="Clear" (click)="serialNumber.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="serialNumber.hasError('required')">
        Serial number is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Name</mat-label>
      <input matInput type="text" [formControl]="name" [errorStateMatcher]="matcher" required />
      <button mat-button *ngIf="name.value" matSuffix mat-icon-button aria-label="Clear" (click)="name.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="name.hasError('required')">
        Name is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Location</mat-label>
      <input type="text"
             placeholder="Location"
             aria-label="Location"
             matInput
             [errorStateMatcher]="matcher"
             [formControl]="location"
             [matAutocomplete]="autoLocations" />
      <mat-autocomplete #autoLocations="matAutocomplete">
        <mat-option *ngFor="let l of locations" [value]="location">
          {{l}}
        </mat-option>
      </mat-autocomplete>
      <button mat-button *ngIf="location.value" matSuffix mat-icon-button aria-label="Clear" (click)="location.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="location.hasError('required')">
        Location is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Room</mat-label>
      <input type="text"
             placeholder="Room"
             aria-label="Room"
             matInput
             [errorStateMatcher]="matcher"
             [formControl]="room"
             [matAutocomplete]="autoRooms">
      <mat-autocomplete #autoRooms="matAutocomplete">
        <mat-option *ngFor="let r of rooms" [value]="room">
          {{r}}
        </mat-option>
      </mat-autocomplete>
      <button mat-button *ngIf="room.value" matSuffix mat-icon-button aria-label="Clear" (click)="room.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="room.hasError('required')">
        Room is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile colspan="4">
    <h3>Sensors</h3>
  </mat-grid-tile>

  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Number Temperature Sensors</mat-label>
      <mat-select [errorStateMatcher]="matcher" [formControl]="numberTemperatureSensors" required>
        <mat-option value="1">One</mat-option>
        <mat-option value="2">Two</mat-option>
        <mat-option value="3">Three</mat-option>
      </mat-select>
      <mat-error *ngIf="numberTemperatureSensors.hasError('required')">
        Number of temperature sensors is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Number Humidity Sensors</mat-label>
      <mat-select [errorStateMatcher]="matcher" [formControl]="numberHumiditySensors" required>
        <mat-option value="1">One</mat-option>
        <mat-option value="2">Two</mat-option>
        <mat-option value="3">Three</mat-option>
      </mat-select>
      <mat-error *ngIf="numberHumiditySensors.hasError('required')">
        Number of humidity sensors is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Number Carbon Dioxide Sensors</mat-label>
      <mat-select [errorStateMatcher]="matcher" [formControl]="numberCarbonDioxideSensors" required>
        <mat-option value="1">One</mat-option>
        <mat-option value="2">Two</mat-option>
        <mat-option value="3">Three</mat-option>
      </mat-select>
      <mat-error *ngIf="numberCarbonDioxideSensors.hasError('required')">
        Number of carbon dioxide sensors is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile colspan="4">
    <h3>Networking</h3>
  </mat-grid-tile>

  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Network Type</mat-label>
      <mat-select [errorStateMatcher]="matcher" [formControl]="networkType" required>
        <mat-option value="Wireless">Wireless</mat-option>
        <mat-option value="Wired">Wired</mat-option>
      </mat-select>
      <mat-error *ngIf="networkType.hasError('required')">
        Network Type is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile *ngIf="networkType.value == 'Wireless'">
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>SSID</mat-label>
      <input matInput type="text" [formControl]="wirelessSsid" [errorStateMatcher]="matcher" >
      <button mat-button *ngIf="wirelessSsid.value" matSuffix mat-icon-button aria-label="Clear" (click)="wirelessSsid.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="wirelessSsid.hasError('required')">
        SSID is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile *ngIf="networkType.value == 'Wireless'">
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Key</mat-label>
      <input matInput type="text" [formControl]="wirelessKey" [errorStateMatcher]="matcher" />
      <button mat-button *ngIf="wirelessKey.value" matSuffix mat-icon-button aria-label="Clear" (click)="wirelessKey.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="wirelessKey.hasError('required')">
        Key is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>IP Configuration</mat-label>
      <mat-select [errorStateMatcher]="matcher" [formControl]="ipType" required>
        <mat-option value="DHCP">DHCP</mat-option>
        <mat-option value="Static">Static</mat-option>
      </mat-select>
      <mat-error *ngIf="ipType.hasError('required')">
        IP configuration is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile *ngIf="ipType.value == 'Static'">
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>IP Address</mat-label>
      <input matInput type="text" [formControl]="ipAddress" [errorStateMatcher]="matcher" />
      <button mat-button *ngIf="ipAddress.value" matSuffix mat-icon-button aria-label="Clear" (click)="ipAddress.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="ipAddress.hasError('required')">
        IP Address is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile *ngIf="ipType.value == 'Static'">
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Broadcast</mat-label>
      <input matInput type="text" [formControl]="ipBroadcast" [errorStateMatcher]="matcher" />
      <button mat-button *ngIf="ipBroadcast.value" matSuffix mat-icon-button aria-label="Clear" (click)="ipBroadcast.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="ipBroadcast.hasError('required')">
        Broadcast is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile *ngIf="ipType.value == 'Static'">
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Gateway</mat-label>
      <input matInput type="text" [formControl]="ipGateway" [errorStateMatcher]="matcher" />
      <button mat-button *ngIf="ipGateway.value" matSuffix mat-icon-button aria-label="Clear" (click)="ipGateway.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="ipGateway.hasError('required')">
        Gateway is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile *ngIf="ipType.value == 'Static'">
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>DNS</mat-label>
      <input matInput type="text" [formControl]="ipDns" [errorStateMatcher]="matcher" />
      <button mat-button *ngIf="ipDns.value" matSuffix mat-icon-button aria-label="Clear" (click)="ipDns.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
      <mat-error *ngIf="ipDns.hasError('required')">
        DNS is required
      </mat-error>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile>
    <mat-form-field class="form-field" appearance="fill">
      <mat-label>Ingestion Server</mat-label>
      <input matInput type="text" [formControl]="serverAddress" [errorStateMatcher]="matcher" />
      <button mat-button *ngIf="serverAddress.value" matSuffix mat-icon-button aria-label="Clear" (click)="serverAddress.setValue('')">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
  </mat-grid-tile>

  <mat-grid-tile colspan="4">
    <button type="button" mat-raised-button color="primary" (click)="this.provisionSensor();" style="width: 95%" [disabled]="!formGroup.valid">
      Go
    </button>
  </mat-grid-tile>
</mat-grid-list>

<mat-divider></mat-divider>
